(()=>{"use strict";const t=t=>t>=0&&t<10?`0${t}`:t;function e(e){return{h:t(Math.floor(e/36e5%24)),m:t(Math.floor(e/6e4%60)),s:t(Math.floor(e/1e3%60))}}!function(t){const n={run:!1,pause:!1,ids:null,length:null,post_type:null,startTime:null,chunkSize:100,formdata:null};function o(){const e=t("#posts-remover-form");n.formdata=e.serialize()}function s(e){const o=n.ids.slice(0,n.chunkSize),s=`${n.formdata}&action=remove_posts_ajax&nonce_code=${bpr_ajax.nonce}&ids=${JSON.stringify(o)}`;console.log(n),t.post({url:bpr_ajax.url,data:s,success:function(t){t.status?e(t):alert(t.message)}})}function i(o){var r=t("#posts-remover-summary"),u=t("#posts-remover-log ol"),c=document.getElementById("posts-remover-log");if(n.run){n.ids=n.ids.slice(n.chunkSize),function(){const e=t(".progressbar");let n=l();n=n.toFixed(2),e.css({width:n+"%",opacity:1}).find(".num").text(n)}(),function(){const o=Date.now()-n.startTime,s=t("#posts-remover-estimate"),i=s.find(".posts-remover-elapsed .time"),r=s.find(".posts-remover-remaining .time"),a=e(o);i.find(".s").html(a.s),i.find(".m").html(a.m),i.find(".h").html(a.h);const u=l(),c=e((100-u)*o/u);r.find(".s").html(c.s),r.find(".m").html(c.m),r.find(".h").html(c.h)}();for(const t in o.log)u.append("<li>"+o.log[t]+"</li>");if(c.scrollTop=c.scrollHeight,!n.ids.length)return r.html("<p>Posts removed</p>"),void a();s(i)}}function r(e){t("#posts-remover-form button[type=submit]").html("Removing...");const o=t("#posts-remover-summary");if(e.status){if(o.html("<p>Found "+e.ids.length+" posts</p>"),!e.ids.length)return void a();n.ids=e.ids,n.run=!0,n.length=e.ids.length,n.post_type=e.post_type,n.startTime=Date.now(),s(i)}else o.html("<p>Select post type first</p>"),a()}function a(){n.run=!1,n.pause=!1,n.ids=null,n.length=null,n.post_type=null,n.startTime=null,n.formdata=null;const e=t("#posts-remover-form"),o=e.find("button[type=submit]");e.removeClass("loading"),o.html("Remove"),t(".glare").removeClass("glare")}function l(){return 100*(n.length-n.ids.length)/n.length}t((function(){const{chunkSize:e}={...bpr};void 0!==e&&(n.chunkSize=e),n.chunkSize=+n.chunkSize,function(){const e=t("#date_from").datepicker({defaultDate:"-1y",changeMonth:!0,numberOfMonths:1}).on("change",(function(){n.datepicker("option","minDate",o(this))})),n=t("#date_to").datepicker({defaultDate:"+1w",changeMonth:!0,numberOfMonths:1}).on("change",(function(){e.datepicker("option","maxDate",o(this))}));function o(e){let n;try{n=t.datepicker.parseDate("mm/dd/yy",e.value)}catch(t){n=null}return n}}(),function(t,e,n,o,s){const i=jQuery("#posts-remover-form");i.on("submit",(function(t){if(t.preventDefault(),i.hasClass("loading"))return;i.addClass("loading");const e=i.serialize()+"&action=get_posts_ids_ajax&nonce_code="+bpr_ajax.nonce;o(),jQuery.ajax({url:bpr_ajax.url,data:e,type:"GET",success:function(t){s(t)}})}))}(0,0,0,o,r)}))}(jQuery)})();